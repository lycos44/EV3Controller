/*
 * This build file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * user guide available at https://docs.gradle.org/current/userguide/java_gradle_plugin.html
 */
//Deploy on Brick
buildscript {
    repositories {
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath "org.hidetake:gradle-ssh-plugin:2.10.1"
    }
}

plugins {
    id 'java'
    id 'application'
    id 'maven-publish'
}

configurations {
    remoteEV3
}

application {
    mainClass = 'de.munro.ev3.rmi.EV3devRMIServer'
}

repositories {
    mavenLocal()
    mavenCentral()
    maven { url "https://jitpack.io" }
}

dependencies {
    implementation project(':remote-ev3')
    implementation 'com.github.ev3dev-lang-java:ev3dev-lang-java:2.5.3'
    implementation 'com.github.ev3dev-lang-java:lejos-navigation:0.2.0'
}

test {
    useJUnitPlatform()
}

//Compile
compileJava {
    sourceCompatibility = 11
    targetCompatibility = 11
}

//Jar
jar {
    manifest {
        attributes (
                'Built-By'       : System.properties['user.name'],
                'Build-Timestamp': new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ").format(new Date())
        )
    }
}

//Fat Jar
task fatJar(type: Jar) {
    archiveBaseName = "${rootProject.name}" + "-all"
    manifest {
        from file("${projectDir}/src/main/resources/META-INF/MANIFEST.MF")
    }
    from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}

